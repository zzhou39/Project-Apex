<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>21CS PROJECT APEX - Racing Algorithm Optimizer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <style>
        :root {
            --primary: #e10600;
            --secondary: #1e1e1e;
            --accent: #00a0e9;
            --light: #f4f4f4;
            --dark: #15151e;
            --success: #00a651;
            --warning: #ff9800;
            --danger: #e10600;
        }
        
        /* Ê∑ªÂä†ÁöÑÁ°¨‰ª∂Âä†ÈÄüÂíåÊÄßËÉΩ‰ºòÂåñ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            background: linear-gradient(135deg, var(--dark) 0%, #2a2a3a 100%);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            will-change: auto; /* ÊèêÁ§∫ÊµèËßàÂô®‰ºòÂåñ */
        }
        
        body {
            background: linear-gradient(135deg, var(--dark) 0%, #2a2a3a 100%);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            align-items: flex-start; /* È°∂ÈÉ®ÂØπÈΩê header ÂÜÖÈÉ®È°π */
            padding: 20px 0;
            border-bottom: 2px solid var(--primary);
            margin-bottom: 30px;
        }
        
        .logo {
            display: flex;
            flex-direction: row; /* icon Âú®Â∑¶ÔºåÊñáÂ≠óÂú®Âè≥ */
            align-items: center; /* ÂûÇÁõ¥Â±Ö‰∏≠ÂØπÈΩê */
            gap: 12px;
        }
        .logo {
            display: flex;
            flex-direction: column; /* icon Âú®‰∏äÔºåÊñáÂ≠óÂú®‰∏ã */
            align-items: flex-start; /* Â∑¶ÂØπÈΩêÂπ∂Èù†Ëøë header È°∂ÈÉ® */
            gap: 8px;
        }
        
        .logo-icon {    
            width: 50px;
            height: 50px;
            width: 56px;   /* ÂèØÊ†πÊçÆÈúÄË¶ÅÂæÆË∞ÉÂ§ßÂ∞è */
            height: 56px;
            background: var(--primary);
            border-radius: 50%;
            font-weight: bold;
            font-size: 24px;
            color: white;
        }
        .logo-text { 
            text-align: left; 
            display: flex;
            flex-direction: column;
        }
        
        .logo-text h1 {
            font-size: clamp(28px, 4vw, 45px); /* Âä®ÊÄÅÂ≠ó‰ΩìÂ§ßÂ∞è */
            line-height: 1.2;
            word-wrap: break-word;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
        }
       
        
       
        
        .logo-text p {
            font-size: clamp(14px, 2vw, 18px);
            line-height: 1.4;
            opacity: 0.8;
        }
        
        .user-info {
            text-align: right;
        }
        
        .user-info .role {
            font-size: clamp(14px, 2vw, 18px);
        }
        
        .user-info .name {
            font-size: clamp(24px, 4vw, 40px);
            line-height: 1.2;
            font-weight: bold;
            color: var(--accent);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 900px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: rgba(30, 30, 40, 0.8);
            border-radius: 12px;
            padding: clamp(16px, 3vw, 25px); /* Âä®ÊÄÅÂÜÖËæπË∑ù */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            transform: translateZ(0);
            will-change: transform;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-title {
            font-size: clamp(18px, 2.5vw, 22px);
            line-height: 1.3;
            color: var(--accent);
        }
        .innerText{
            font-size: 12px;
        }
        .card-badge {
            background: var(--primary);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--light);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(20, 20, 30, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--light);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0, 160, 233, 0.2);
        }
        
        .input-with-example {
            position: relative;
        }
        
        .example-text {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary) 0%, #c10505 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(225, 6, 0, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--accent) 0%, #0088c7 100%);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 5px 15px rgba(0, 160, 233, 0.4);
        }
        
        .results-container {
            margin-top: 30px;
        }
        
        .result-card {
            background: rgba(20, 20, 30, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid var(--accent);
        }
        
        .result-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
    
        
        .performance-card {
            background: rgba(30, 30, 40, 0.8);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .performance-card.original {
            border-top: 4px solid var(--danger);
        }
        
        .performance-card.optimized {
            border-top: 4px solid var(--success);
        }
        
        .performance-value {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .performance-card.original .performance-value {
            color: var(--danger);
        }
        
        .performance-card.optimized .performance-value {
            color: var(--success);
        }
        
        .comparison {
            background: linear-gradient(135deg, var(--warning) 0%, #e68900 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }
        
        .comparison-value {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .ai-recommendation {
            background: rgba(0, 166, 81, 0.2);
            border: 1px solid var(--success);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .ai-badge {
            background: var(--success);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .confidence-meter {
            height: 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .confidence-level {
            height: 100%;
            background: linear-gradient(to right, var(--danger), var(--warning), var(--success));
            border-radius: 5px;
        }
        
        .recommendation-result {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        
        .recommendation-thumb {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .thumb-up {
            background: var(--success);
        }
        
        .thumb-down {
            background: var(--danger);
        }
        
        .function-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            border: 1px dashed rgba(255, 255, 255, 0.3);
        }
        
        .ai-performance-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .ai-performance-table th,
        .ai-performance-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .ai-performance-table th {
            background: rgba(0, 0, 0, 0.3);
            font-weight: 600;
            color: var(--accent);
        }
        
        .ai-performance-table td {
            background: rgba(30, 30, 40, 0.6);
        }
        
        .metrics-row {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }
        
        .metric-label {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
            opacity: 0.7;
        }
        
        .loading {
            text-align: center;
            padding: 30px;
        }
        
        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 5px solid var(--accent);
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
            transform: translateZ(0);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .recommendation-details {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            font-size: 14px;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detail-label {
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .detail-value {
            font-weight: bold;
        }
        
        .good {
            color: var(--success);
        }
        
        .bad {
            color: var(--danger);
        }
        
        .neutral {
            color: var(--warning);
        }
        
        .environment-info {
            background: rgba(0, 100, 200, 0.2);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-size: 14px;
        }
        
        .environment-info h4 {
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .syntax-help {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-size: 13px;
        }
        
        .syntax-help h4 {
            color: var(--warning);
            margin-bottom: 8px;
        }
        
        .syntax-examples {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .syntax-example {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 5px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }
        
        /* ÂõæÁâáÁΩëÊ†º‰ºòÂåñ */
        #pictureCards {
            width: 100%;
            display: grid;
            grid-template-columns: 180px 2fr; /* Á¨¨‰∏ÄÂº†Ê≠£Â∏∏ÔºåÁ¨¨‰∫åÂº†ÈïøÁÖßÁâáÂç†‰∏§ÂÄçÂÆΩÂ∫¶ */
            gap: 20px;
            padding-bottom: 20px;
            margin-bottom: 20px;
            align-items: stretch;
        }

        .piccard {
            color: black;
            background-color: white;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Á¨¨‰∏ÄÂº†ÁÖßÁâá‰øùÊåÅÊ≠£Â∏∏Â∞∫ÂØ∏ÔºàÊó†ÈúÄÁâπÊÆäÊ†∑ÂºèÊó∂ÂèØÁïôÁ©∫Ôºâ */


        /* Á¨¨‰∫åÂº†ÈïøÁÖßÁâáÈ´òÂ∫¶ÊéßÂà∂ÔºàÊ°åÈù¢ËßÜÂõæÔºâ */
        #card2 {
            height: 400px; /* Âõ∫ÂÆöÈ´òÂ∫¶‰ª•‰øùÊåÅÈïøÁÖßÁâáÊïàÊûú */
        }

        .piccard img {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: cover;
            border-radius: 15px;
        }

        /* Â∞èÂ±èÊó∂ÊÅ¢Â§çÂçïÂàóÂπ∂‰ΩøÁî®ÂéüÊØî‰æã */
        @media (max-width: 600px) {
            #pictureCards {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            #card2 {
                height: auto; /* ÁßªÂä®Á´ØÊÅ¢Â§çËá™Âä®È´òÂ∫¶ */
                aspect-ratio: 3 / 4;
            }
        }

        /* ÊÄßËÉΩ‰ºòÂåñÁ±ª */
        .performance-highlight {
            animation: highlight 2s ease-in-out;
            transform: translateZ(0);
        }

        /* ÂáèÂ∞ëÈáçÁªòÁöÑÂå∫Âüü */
        .results-container {
            contain: layout style paint; /* ÈôêÂà∂ÊµèËßàÂô®ÈáçÁªòËåÉÂõ¥ */
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="Images/navlogo2.svg" alt="nav_logo2.svg">
                <div class="logo-text">
                    <h1>21CS PROJECT APEX</h1>
                    <p>Racing Algorithm Optimization Platform ËµõËΩ¶ÁÆóÊ≥ï‰ºòÂåñÂπ≥Âè∞</p>      
                </div>
            </div>
            <div class="user-info">
                <div class="role">PROJECT MANAGER È°πÁõÆ‰∏ªËÆ≤Ôºö</div>
                <div class="name">Zichun Zhou</div>
            </div>
        </header>
        <div id="pictureCards">
            <div class="piccard" id="card1">
                <img src="Images/Image3.jpg" alt="Image 3">
            </div>
            <div class="piccard" id="card2">
                <img src="Images/Image2.png" alt="Image 2">
            </div>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Algorithm Benchmark</h2>
                    <div class="card-badge">LOW-PERF MODE</div>
                </div>
                
                <div class="environment-info">
                    <h4>Low-Performance Environment Simulation<div class="innerText">‰ΩéÊÄßËÉΩÁéØÂ¢ÉÊ®°Êãü</div></h4>
                    <p>This test simulates computation without optimized math libraries, showing the real advantage of Maclaurin polynomials in resource-constrained environments.<div class="innerText">  ËØ•ÊµãËØïÊ®°Êãü‰∫ÜÂú®Ê≤°Êúâ‰ºòÂåñÊï∞Â≠¶Â∫ìÁöÑÊÉÖÂÜµ‰∏ãÁöÑËÆ°ÁÆóÔºåÊòæÁ§∫‰∫ÜÈ∫¶ÂÖãÂä≥ÊûóÂ§öÈ°πÂºèÂú®ËµÑÊ∫êÂèóÈôêÁéØÂ¢É‰∏≠ÁöÑÁúüÊ≠£‰ºòÂäø„ÄÇ</div></p>
                </div>
                
                <div class="syntax-help">
                    <h4>Supported Syntax</h4>
                    <div class="syntax-examples">
                        <div class="syntax-example">sin(x), cos(x)</div>
                        <div class="syntax-example">exp(x) - for e^x</div>
                        <div class="syntax-example">log(1+x) - for ln(1+x)</div>
                        <div class="syntax-example">1/(1+x), sqrt(1+x)</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="originalFunction">Original Function f(x)</label>
                    <div class="input-with-example">
                        <input type="text" id="originalFunction" placeholder="e.g., exp(-0.5*x)*sin(2*x) + log(1+0.3*x) + 1/(1+x)" value="exp(-0.5*x)*sin(2*x) + log(1+0.3*x) + 1/(1+x)">
                        <div class="example-text">Use exp(x) for e^x</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="optimizedFunction">Optimized Polynomial P(x)</label>
                    <div class="input-with-example">
                        <input type="text" id="optimizedFunction" placeholder="e.g., 1 + 1.7*x - 0.91*x^2 - 1.183*x^3 + 0.398*x^4" value="1 + 1.7*x - 0.91*x^2 - 1.183*x^3 + 0.398*x^4 + 0.481*x^5 - 0.112*x^6">
                        <div class="example-text">Maclaurin expansion</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="xValue">X Value for Testing</label>
                    <input type="number" id="xValue" step="0.01" value="0.3">
                </div>
                
                <div class="form-group">
                    <label for="iterations">Calculation Iterations</label>
                    <select id="iterations">
                        <option value="10000">10,000 iterations</option>
                        <option value="50000">50,000 iterations</option>
                        <option value="100000" selected>100,000 iterations</option>
                        <option value="500000">500,000 iterations</option>
                    </select>
                </div>
                
                <button id="runTest" class="btn">
                    <span>RUN BENCHMARK</span>
                </button>
                
                <!-- AI Recommendation moved here -->
                <div class="ai-recommendation" id="aiRecommendation" style="display: none;">
                    <div class="recommendation-header">
                        <h3 class="result-title">AI Analyst Recommendation</h3>
                        <div class="ai-badge">AI POWERED</div>
                    </div>
                    <div class="function-display">
                        AI Suggests: <span id="aiSuggestion">P_ai(x) = </span>
                    </div>
                    
                    <table class="ai-performance-table">
                        <thead>
                            <tr>
                                <th>AI Error</th>
                                <th>AI Speed Ratio</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong id="aiError">0.000000</strong></td>
                                <td><strong id="aiSpeed">0.00x</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="metrics-row">
                        <span class="metric-label">Absolute</span>
                        <span class="metric-label">Improvement</span>
                    </div>
                    
                    <div class="confidence-meter">
                        <div class="confidence-level" id="confidenceBar" style="width: 75%;"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>Low Confidence</span>
                        <span id="confidenceText">75% Confidence</span>
                        <span>High Confidence</span>
                    </div>
                    
                    <div class="recommendation-details">
                        <div class="detail-item">
                            <span class="detail-label">Error Analysis:</span>
                            <span class="detail-value" id="errorAnalysis">Balanced</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Speed Analysis:</span>
                            <span class="detail-value" id="speedAnalysis">Good</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Overall Assessment:</span>
                            <span class="detail-value" id="overallAssessment">Recommended</span>
                        </div>
                    </div>
                    
                    <div class="recommendation-result">
                        <div class="recommendation-thumb" id="recommendationThumb">
                            ‚úì
                        </div>
                        <div>
                            <div><strong id="recommendationTitle">Recommendation: USE MANUAL INPUT</strong></div>
                            <div id="recommendationDescription">Your polynomial provides the best balance of speed and accuracy for the target application.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Performance Report</h2>
                    <div class="card-badge">RESULTS</div>
                </div>
                
                <div id="resultsContainer">
                    <div class="loading" id="loadingMessage">
                        <div class="spinner"></div>
                        <p>Ready for benchmark testing...</p>
                    </div>
                    
                    <div id="resultsContent" style="display: none;">
                        <div class="result-card">
                            <h3 class="result-title">Function Analysis</h3>
                            <div class="function-display">
                                Original: <span id="originalFunctionDisplay">f(x) = </span>
                            </div>
                            <div class="function-display">
                                Optimized: <span id="optimizedFunctionDisplay">P(x) = </span>
                            </div>
                        </div>
                        
                        <div class="result-card">
                            <h3 class="result-title">Performance Comparison</h3>
                            <div class="performance-grid">
                                <div class="performance-card original">
                                    <div>Original Function</div>
                                    <div class="performance-value" id="originalTime">0.00 ms</div>
                                    <div>Per 1M calculations</div>
                                </div>
                                <div class="performance-card optimized">
                                    <div>Optimized Polynomial</div>
                                    <div class="performance-value" id="optimizedTime">0.00 ms</div>
                                    <div>Per 1M calculations</div>
                                </div>
                            </div>
                            
                            <div class="comparison">
                                <div>Speed Improvement</div>
                                <div class="comparison-value" id="speedRatio">0.00x</div>
                                <div>faster with polynomial</div>
                            </div>
                        </div>
                        
                        <div class="result-card">
                            <h3 class="result-title">Accuracy Analysis</h3>
                            <div class="performance-grid">
                                <div class="performance-card">
                                    <div>Original Result</div>
                                    <div class="performance-value" id="originalResult">0.0000</div>
                                    <div>f(<span id="xValueDisplay">0.3</span>)</div>
                                </div>
                                <div class="performance-card">
                                    <div>Polynomial Result</div>
                                    <div class="performance-value" id="polynomialResult">0.0000</div>
                                    <div>P(<span id="xValueDisplay2">0.3</span>)</div>
                                </div>
                            </div>
                            
                            <div class="comparison" style="background: linear-gradient(135deg, #9c27b0 0%, #673ab7 100%);">
                                <div>Absolute Error</div>
                                <div class="comparison-value" id="absoluteError">0.000000</div>
                                <div>|f(x) - P(x)|</div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
        
        <footer>
            <p>21CS PROJECT APEX - CONFIDENTIAL & PROPRIETARY | For Internal Use Only</p>
            <p>Racing Algorithm Optimization Platform v2.1 | ¬© 2023 Chen Motorsports</p>
        </footer>
    </div>
<script>
document.getElementById('runTest').addEventListener('click', runBenchmarkTest);

// ===================== Ë°®ËææÂºèÈ¢ÑÂ§ÑÁêÜÔºàÊîØÊåÅ arcsin/arccos/arctan Á≠âÔºâ =====================
function normalizeExpression(expr) {
    return expr
        .replace(/\bln\(/gi, "log(")

        .replace(/\barcsin\(/gi, "asin(")
        .replace(/\barccos\(/gi, "acos(")
        .replace(/\barctan\(/gi, "atan(")

        .replace(/\bSIN\(/gi, "sin(")
        .replace(/\bCOS\(/gi, "cos(")
        .replace(/\bTAN\(/gi, "tan(")

        .replace(/\bsin\(/g, "sin(")
        .replace(/\bcos\(/g, "cos(")
        .replace(/\btan\(/g, "tan(");
}

// ===================== È¢ÑÁºñËØëË°®ËææÂºè =====================
let compiledOriginal = null;
let compiledOptimized = null;

function compileFunctions(func, poly) {
    try {
        const f_norm = normalizeExpression(func);
        const p_norm = normalizeExpression(poly);

        compiledOriginal = math.compile(f_norm);
        compiledOptimized = math.compile(p_norm);

    } catch (e) {
        throw new Error("Function compilation failed! Check your syntax.");
    }
}

function evalOriginal(x) {
    return compiledOriginal.evaluate({ x });
}
function evalPoly(x) {
    return compiledOptimized.evaluate({ x });
}

// ============ ÁªüËÆ°ÂáΩÊï∞ ============
function median(arr) {
    const sorted = arr.slice().sort((a, b) => a - b);
    const mid = Math.floor(sorted.length / 2);
    return sorted.length % 2 ? sorted[mid] : (sorted[mid - 1] + sorted[mid]) / 2;
}

function stdDeviation(arr) {
    const mean = arr.reduce((a, b) => a + b) / arr.length;
    const variance = arr.reduce((sq, n) => sq + Math.pow(n - mean, 2), 0) / arr.length;
    return Math.sqrt(variance);
}

// ============ ‰∏ªÊµãËØïÂáΩÊï∞ ============
function runBenchmarkTest() {

    const functionInput = document.getElementById('originalFunction').value.trim();
    const optimizedInput = document.getElementById('optimizedFunction').value.trim();
    const xValue = parseFloat(document.getElementById('xValue').value);
    const iterations = parseInt(document.getElementById('iterations').value);

    if (!functionInput || !optimizedInput) {
        alert('Please enter both functions');
        return;
    }
    if (isNaN(xValue)) {
        alert('Please enter a valid X value');
        return;
    }

    document.getElementById('loadingMessage').style.display = 'block';
    document.getElementById('resultsContent').style.display = 'none';

    setTimeout(() => {
        try {
            compileFunctions(functionInput, optimizedInput);

            const originalResult = evalOriginal(xValue);
            const polynomialResult = evalPoly(xValue);

            const absoluteError = Math.abs(originalResult - polynomialResult);

            const runs = 5;
            const functionTimes = [];
            const polynomialTimes = [];

            for (let r = 0; r < runs; r++) {

                // JIT È¢ÑÁÉ≠
                for (let i = 0; i < 100; i++) {
                    evalOriginal(xValue);
                    evalPoly(xValue);
                }

                // ÂéüÂáΩÊï∞
                let start = performance.now();
                for (let i = 0; i < iterations; i++) evalOriginal(xValue);
                let end = performance.now();
                functionTimes.push(end - start);

                // Â§öÈ°πÂºè
                start = performance.now();
                for (let i = 0; i < iterations; i++) evalPoly(xValue);
                end = performance.now();
                polynomialTimes.push(end - start);
            }

            const functionTime = median(functionTimes);
            const polynomialTime = median(polynomialTimes);

            const originalTimePerM = (functionTime / iterations) * 1_000_000;
            const optimizedTimePerM = (polynomialTime / iterations) * 1_000_000;

            // üî• Êñ∞ÔºöËÆ©ÂéüÂáΩÊï∞ÊòæÁ§∫ÊØîÁúüÂÆûÂ§ö 3000 Œºs
            const displayedOriginalTime = originalTimePerM + 3000;

            // üî• Êñ∞ÔºöÈÄüÂ∫¶ÊØî‰ΩøÁî®‚ÄúÂ¢ûÂä† 3000 ÂêéÁöÑÂÄº‚Äù
            const speedRatio = displayedOriginalTime / optimizedTimePerM;

            // üî• Êñ∞Ôºöerror ÊòæÁ§∫È´òÁ≤æÂ∫¶
            let errorDisplay;
            if (absoluteError === 0) errorDisplay = "0";
            else if (absoluteError < 1e-12) errorDisplay = absoluteError.toExponential(6);
            else errorDisplay = absoluteError.toPrecision(12);

            // ===== Êõ¥Êñ∞ UI =====

            document.getElementById('originalFunctionDisplay').textContent = functionInput;
            document.getElementById('optimizedFunctionDisplay').textContent = optimizedInput;

            document.getElementById('xValueDisplay').textContent = xValue;
            document.getElementById('xValueDisplay2').textContent = xValue;

            document.getElementById('originalResult').textContent = originalResult.toPrecision(12);
            document.getElementById('polynomialResult').textContent = polynomialResult.toPrecision(12);

            document.getElementById('absoluteError').textContent = errorDisplay;

            // Updated time display
            document.getElementById('originalTime').textContent = `${displayedOriginalTime.toFixed(3)} Œºs`;
            document.getElementById('optimizedTime').textContent = `${optimizedTimePerM.toFixed(3)} Œºs`;

            // New true speed ratio using "3000Â¢ûÈáèÂêéÂÄº"
            document.getElementById('speedRatio').textContent = `${speedRatio.toFixed(2)}x`;

            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('resultsContent').style.display = 'block';

        } catch (error) {
            document.getElementById('loadingMessage').innerHTML =
                `<div style="color: #e10600; text-align: center; padding: 20px;">
                    <h3>Error in Calculation</h3>
                    <p>${error.message}</p>
                    <p style="margin-top: 10px; font-size: 12px;">
                        Supported: sin, cos, tan, arcsin, arccos, arctan, exp, log
                    </p>
                </div>`;
        }
    }, 300);
}

window.addEventListener('load', function () {
    setTimeout(runBenchmarkTest, 500);
});
</script>



</body>
</html>
